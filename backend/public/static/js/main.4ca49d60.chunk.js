(this.webpackJsonpfront=this.webpackJsonpfront||[]).push([[0],{121:function(e,t){},135:function(e,t,n){},136:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(36),o=n.n(c),l=n(3),s=n(2),u=n(14),i=Object(a.createContext)(null),m=n(1),p=n.n(m),d=n(63),g=n.n(d),f=n(21),E=f.baseURL,v=f.env;console.log(v,"this is the environment for react");var y="".concat(E,"/api/"),h=g.a.create({withCredentials:!0}),b=function(e,t){return x(e,"GET",t)},w=function(e,t){return x(e,"POST",t)},N=function(e,t){return x(e,"PUT",t)},O=function(e,t){return x(e,"DELETE",t)};function x(e){var t,n,a,r=arguments;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return t=r.length>1&&void 0!==r[1]?r[1]:"get",n=r.length>2&&void 0!==r[2]?r[2]:null,c.prev=2,c.next=5,p.a.awrap(h({url:"".concat(y).concat(e),method:t,data:n}));case 5:return a=c.sent,c.abrupt("return",a.data);case 9:if(c.prev=9,c.t0=c.catch(2),console.log("Had Issues ".concat(t,"ing to the backend, endpoint: ").concat(y).concat(e,", with data: ").concat(n)),console.dir(c.t0),!c.t0.response||401!==c.t0.response.status){c.next=17;break}window.location.assign("/#/login"),c.next=18;break;case 17:throw c.t0;case 18:case"end":return c.stop()}}),null,null,[[2,9]])}var C=n(12),j=n.n(C),I={loginCompany:function(e){var t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p.a.awrap(w("auth/login",e));case 2:return t=n.sent,n.abrupt("return",_(t));case 4:case"end":return n.stop()}}))},logoutCompany:function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.awrap(w("auth/logout"));case 2:j.a.remove("loggedCompany"),sessionStorage.clear();case 4:case"end":return e.stop()}}))},signupCompany:function(e){var t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p.a.awrap(w("auth/signup",e));case 2:return t=n.sent,n.abrupt("return",_(t));case 4:case"end":return n.stop()}}))},getCompanies:function(){return b("company")},getCompanyById:function(e){return b("company/".concat(e))},removeCompany:function(e){return O("company/".concat(e))},updateCompany:function(e){return N("company/edit/".concat(e._id),e)}};function _(e){return sessionStorage.setItem("company",JSON.stringify(e)),e}var S=function(e){Object(a.useContext)(i).loggedCompany;var t=Object(u.f)();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("h1",null,"Welcome to Presence Board"),r.a.createElement("h2",null,"Here you can see who is prescense in a bit of a second")),r.a.createElement("div",{className:"cta-container"},r.a.createElement("div",null,r.a.createElement("h2",null,"Your company is registered?"),r.a.createElement("button",{onClick:function(){t.push("/login")}},"Log in now!")),r.a.createElement("div",null,r.a.createElement("h2",null,"New here? add your company"),r.a.createElement("button",{onClick:function(){t.push("/login?newCompany=1")}},"Register Now!"))),r.a.createElement("div",null,"HELLO"),r.a.createElement("button",{onClick:function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.awrap(I.getCompanies());case 2:e=t.sent,console.log(e);case 4:case"end":return t.stop()}}))}},"RETRIEVE"))},k={getAllEmployees:function(){return b("employee")},getEmployeeById:function(e){return b("employee/".concat(e))},removeEmployee:function(e){return O("employee/".concat(e))},updateEmployee:function(e){return N("employee/edit/".concat(e._id),e)},addEmployee:function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.awrap(w("employee",e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}))},getAllEmployeesInCompany:function(e){return b("employee/company/".concat(e))},updateEmployeePresence:function(e,t){return console.log(e,t),N("employee/presence",{employeeId:e,isPresence:t})}};var L=n(37),P=n.n(L);function U(e){var t=e.emp,n=e.onChangePresence,c=Object(a.useState)(!1),o=Object(l.a)(c,2),s=o[0],u=o[1];return r.a.createElement("article",{id:"".concat(t._id,"-card"),className:"employee-card",onClick:function(){return e=t._id,p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("HERE?"),u(!0),t.next=4,p.a.awrap(n(e));case 4:u(!1);case 5:case"end":return t.stop()}}));var e}},r.a.createElement("div",{className:"click-loader"},s&&r.a.createElement(P.a,{width:"100px",height:"100px"})),r.a.createElement("p",null,t.firstName+" "+t.lastName),r.a.createElement("img",{id:t._id,src:t.image,alt:"profile",className:[t.isPresence?"color":"gray","employee-card-img"].join(" ")}))}var A=function(e){var t=e.employees,n=e.onChangePresence;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"employee-list"},t.map((function(e){return r.a.createElement(U,{onChangePresence:n,key:e._id,emp:e})}))))},R=n(28),B=n.n(R);var D=n(21).baseURL,T=B()(D),F=function(e){var t=Object(u.f)(),n=Object(a.useContext)(i),c=n.loggedCompany,o=n.setLoggedCompany,s=Object(a.useState)(null),m=Object(l.a)(s,2),d=m[0],g=m[1],f=Object(a.useState)(!1),E=Object(l.a)(f,2),v=E[0],y=E[1];Object(a.useEffect)((function(){!function(){var e;p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(c){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,p.a.awrap(k.getAllEmployeesInCompany(c.id));case 4:e=t.sent,console.log(e,"res"),g(e);case 7:case"end":return t.stop()}}))}()}),[c,v]),Object(a.useEffect)((function(){c&&T.emit("board_page",c.id)}),[T,c]);return Object(a.useEffect)((function(){T.on("update_board",(function(e){!function(e){var t,n,a;p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.companyId,n=e.employeeId,console.log("I NEED TO REFRESH"),document.getElementById("".concat(n)).classList.toggle("gray"),r.next=5,p.a.awrap(k.getAllEmployeesInCompany(t));case 5:a=r.sent,console.log(a,"res"),g(a);case 8:case"end":return r.stop()}}))}({companyId:e.companyId,employeeId:e.employeeId})}))}),[T]),c?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.awrap(I.logoutCompany());case 2:o(null),t.push("/");case 4:case"end":return e.stop()}}))}},"Logout")),r.a.createElement("img",{className:"board-logo-img",src:c.logo}),r.a.createElement("div",{className:"board-container"},d?r.a.createElement(A,{onChangePresence:function(e){var t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log(e),n.prev=1,document.getElementById("".concat(e)).classList.toggle("gray"),n.next=5,p.a.awrap(k.updateEmployeePresence(e));case 5:return t=n.sent,console.log(t),n.next=9,p.a.awrap(T.emit("update_board",{companyId:c.id,employeeId:e}));case 9:y(!v),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(1),console.log(n.t0);case 15:case"end":return n.stop()}}),null,null,[[1,12]])},employees:d}):r.a.createElement("div",null,"LOADING"))):r.a.createElement("div",null,"Loading...")},q=n(13),H=n(20),J=n(15),M=n.n(J),V=function(e){var t=Object(u.f)(),n=Object(a.useContext)(i),c=n.loggedCompany,o=n.setLoggedCompany;c&&t.push("/board");var s=Object(a.useRef)(null),m=Object(a.useState)(null),d=Object(l.a)(m,2),g=d[0],f=d[1],E=Object(a.useState)(""),v=Object(l.a)(E,2),y=(v[0],v[1],Object(a.useState)({companyId:"",password:""})),h=Object(l.a)(y,2),b=h[0],w=h[1],N=Object(a.useState)({companyName:"",password:""}),O=Object(l.a)(N,2),x=O[0],C=O[1];Object(a.useEffect)((function(){var t=document.getElementById("signUp"),n=document.getElementById("signIn"),a=document.getElementById("container");t.addEventListener("click",(function(){a.classList.add("right-panel-active")})),n.addEventListener("click",(function(){a.classList.remove("right-panel-active")})),new URLSearchParams(e.location.search).get("newCompany")&&s.current.click()}),[]),Object(a.useEffect)((function(){!function(){var e,t;p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p.a.awrap(I.getCompanies());case 2:e=n.sent,t=[],console.log(e),e.forEach((function(e){t.push({label:e.name,value:e._id})})),f(t);case 7:case"end":return n.stop()}}))}()}),[]);var j=function(e){e.persist();var t=e.target.name,n=e.target.value;C((function(e){return Object(H.a)({},e,Object(q.a)({},t,n))}))};return r.a.createElement("div",{className:"login-signup-page"},r.a.createElement("div",{className:"container",id:"container"},r.a.createElement("div",{className:"form-container sign-up-container"},r.a.createElement("form",{action:"#",onSubmit:function(e){var t,n,a;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.preventDefault(),console.log("check"),t=x.companyName,n=x.password,t&&n){r.next=5;break}return r.abrupt("return",console.log("missing creds"));case 5:return r.next=7,p.a.awrap(I.signupCompany({name:t,password:n}));case 7:a=r.sent,o(a),console.log("signedupSucces");case 10:case"end":return r.stop()}}))}},r.a.createElement("h1",null,"Create Account"),r.a.createElement("span",null,"Enter your company's name"),r.a.createElement("input",{name:"companyName",value:x.companyName,onChange:j,type:"text",placeholder:"Company Name"}),r.a.createElement("input",{name:"password",value:x.password,onChange:j,type:"password",placeholder:"Password"}),r.a.createElement("button",null,"Sign Up"))),r.a.createElement("div",{className:"form-container sign-in-container"},r.a.createElement("form",{action:"#",onSubmit:function(e){var t,n,a;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.preventDefault(),console.log("doLogin"),t=b.companyId,n=b.password,console.log(b),t&&n){r.next=6;break}return r.abrupt("return",console.log("missing creds"));case 6:return r.next=8,p.a.awrap(I.loginCompany({companyId:t,password:n}));case 8:a=r.sent,o(a),console.log("signedupSucces");case 11:case"end":return r.stop()}}))}},r.a.createElement("h1",null,"Sign in"),r.a.createElement("div",{className:"selectCompany"},r.a.createElement(M.a,{options:g,values:b.company,onChange:function(e){return function(e){var t=e[0];w((function(e){return Object(H.a)({},e,{companyId:t.value})}))}(e)}})),r.a.createElement("input",{name:"password",value:b.password,onChange:function(e){e.persist();var t=e.target.name,n=e.target.value;w((function(e){return Object(H.a)({},e,Object(q.a)({},t,n))})),console.log(b)},type:"password",placeholder:"Password"}),r.a.createElement("button",null,"Sign In"))),r.a.createElement("div",{className:"overlay-container"},r.a.createElement("div",{className:"overlay"},r.a.createElement("div",{className:"overlay-panel overlay-left"},r.a.createElement("h1",null,"Welcome Back!"),r.a.createElement("p",null,"To see who is here, please login"),r.a.createElement("button",{className:"ghost",id:"signIn"},"Sign In")),r.a.createElement("div",{className:"overlay-panel overlay-right"},r.a.createElement("h1",null,"Hello, New Company!"),r.a.createElement("p",null,"Enter your company's name and join us!"),r.a.createElement("button",{ref:s,className:"ghost",id:"signUp"},"Sign Up"))))))};function W(e){var t,n,a,r;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return"echoshare",t="https://api.cloudinary.com/v1_1/".concat("echoshare","/auto/upload"),(n=new FormData).append("file",e.target.files[0]),n.append("upload_preset","echoshareImgs"),c.prev=5,c.next=8,p.a.awrap(fetch(t,{method:"POST",body:n}));case 8:return a=c.sent,c.next=11,p.a.awrap(a.json());case 11:return r=c.sent,console.log(r),c.abrupt("return",r.secure_url);case 16:c.prev=16,c.t0=c.catch(5),console.log(c.t0);case 19:case"end":return c.stop()}}),null,null,[[5,16]])}var G=function(e){var t=Object(a.useState)({firstName:"",lastName:""}),n=Object(l.a)(t,2),c=n[0],o=n[1],s=Object(a.useState)(!1),u=Object(l.a)(s,2),i=u[0],m=u[1],d=function(e){e.persist();var t=e.target.name,n=e.target.value;o((function(e){return Object(H.a)({},e,Object(q.a)({},t,n))}))},g=Object(a.useState)("https://res.cloudinary.com/echoshare/image/upload/v1634132726/productImgs/799-7998561_add-photo-placeholder-north-luwu-regency_qb0eii.jpg"),f=Object(l.a)(g,2),E=f[0],v=f[1];return r.a.createElement("div",{className:"popup-box"},r.a.createElement("div",{className:"box"},r.a.createElement("span",{className:"close-icon",onClick:e.handleClose},"x"),r.a.createElement("form",{onSubmit:function(t){var n;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(t.preventDefault(),"https://res.cloudinary.com/echoshare/image/upload/v1634132726/productImgs/799-7998561_add-photo-placeholder-north-luwu-regency_qb0eii.jpg"!==E){a.next=4;break}return console.log("You must upload a photo"),a.abrupt("return");case 4:return n={firstName:c.firstName,lastName:c.lastName,image:E,company:e.companyId},console.log(n),a.next=8,p.a.awrap(k.addEmployee(n));case 8:a.sent,e.handleClose();case 10:case"end":return a.stop()}}))}},r.a.createElement("input",{minLength:"5",required:!0,type:"text",name:"firstName",value:c.firstName,placeholder:"Employee First Name",onChange:d}),r.a.createElement("input",{minLength:"5",required:!0,type:"text",name:"lastName",value:c.lastName,placeholder:"Employee Last Name",onChange:d}),r.a.createElement("label",null,r.a.createElement("div",{className:"img-upload"},r.a.createElement("img",{className:"primary-img",src:E})),r.a.createElement("input",{hidden:!0,onChange:function(e){var t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e.persist(),m(!0),n.next=4,p.a.awrap(W(e));case 4:t=n.sent,v(t),m(!1);case 7:case"end":return n.stop()}}))},type:"file"})),r.a.createElement("input",Object(q.a)({type:"text",disabled:i,name:"company-name",value:e.company},"disabled",!0)),r.a.createElement("button",null,"Add"))))};function Y(e){var t=e.emp;return(r.a.createElement("tr",null,r.a.createElement("td",null,t.firstName),r.a.createElement("td",null,t.lastName),r.a.createElement("td",{className:"image-cell"},r.a.createElement("img",{src:t.image,alt:"profile",className:"employee-card-img"})," "),r.a.createElement("td",null,r.a.createElement("button",null,r.a.createElement("img",{src:"https://res.cloudinary.com/echoshare/image/upload/v1636982096/Edit_icon__the_Noun_Project_30184_.svg_lvvq3f.png"})),r.a.createElement("button",null,r.a.createElement("img",{src:"https://res.cloudinary.com/echoshare/image/upload/v1636983047/cross-in-circle-in-red-tom-hill-transparent_qohafi.png"})))))}var $=function(e){var t=e.employees;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"table-header"},r.a.createElement("table",{cellPadding:"0",cellSpacing:"0",border:"0"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"First Name"),r.a.createElement("th",null,"Last Name"),r.a.createElement("th",null,"Profile Photo"),r.a.createElement("th",null,"Actions"))))),r.a.createElement("div",{className:"table-content"},r.a.createElement("table",{cellSpacing:"0",cellPadding:"0",border:"0"},r.a.createElement("tbody",null,t.map((function(e){return r.a.createElement(Y,{key:e._id,emp:e})}))))))},z=function(e){Object(u.f)();var t=Object(a.useContext)(i),n=t.loggedCompany,c=(t.setLoggedCompany,Object(a.useState)(!1)),o=Object(l.a)(c,2),s=o[0],m=o[1],d=function(){m(!s)},g=Object(a.useState)(null),f=Object(l.a)(g,2),E=f[0],v=f[1];return Object(a.useEffect)((function(){!function(){var e;p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,p.a.awrap(k.getAllEmployeesInCompany(n.id));case 4:e=t.sent,console.log(e,"res"),v(e);case 7:case"end":return t.stop()}}))}()}),[n]),n?r.a.createElement(r.a.Fragment,null,s&&r.a.createElement(G,{companyId:n.id,company:n.name,handleClose:d}),r.a.createElement("div",{className:"profile-container"},r.a.createElement("img",{src:n.logo})),r.a.createElement("button",{onClick:d}," Add new Employee"),r.a.createElement("button",null,"Add Bulk Employees"),E?r.a.createElement($,{employees:E}):r.a.createElement("div",null,"LOADING")):r.a.createElement("div",null,"Loading...")};function K(e){var t=Object(a.useContext)(i).loggedCompany;Object(a.useEffect)((function(){}),[t]);j.a.get("loggedCompany");return r.a.createElement("div",{className:"header"},r.a.createElement(s.b,{to:"/"},r.a.createElement("img",{src:t?t.logo:"https://res.cloudinary.com/echoshare/image/upload/v1636287815/echo_icon_q1hjeb.png"})),t&&r.a.createElement("div",{className:"company-name"},t.name),r.a.createElement("div",{className:"links"},t&&r.a.createElement(s.b,{activeClassName:"active",to:"/company",exact:!0},"Company Profile"),t&&r.a.createElement(s.b,{activeClassName:"active",to:"/board"},"Board"),!t&&r.a.createElement(s.b,{activeClassName:"active",to:"/login"},"Sign In"),r.a.createElement(s.b,{activeClassName:"active",to:"/about"},"About")))}var Q=function(){var e=Object(a.useState)(null),t=Object(l.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){if(!n&&j.a.get("loggedCompany")){var e=j.a.get("loggedCompany").slice(2);c(JSON.parse(e))}}),[n]),r.a.createElement("div",{className:"App"},r.a.createElement(s.a,null,r.a.createElement(i.Provider,{value:{loggedCompany:n,setLoggedCompany:c}},r.a.createElement(K,null),r.a.createElement("div",{className:"content"},r.a.createElement(u.c,null,r.a.createElement(u.a,{path:"/",component:S,exact:!0}),r.a.createElement(u.a,{path:"/login",component:V}),r.a.createElement(u.a,{path:"/board",component:F}),r.a.createElement(u.a,{path:"/company",component:z}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(135);o.a.render(r.a.createElement(Q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},21:function(e,t,n){var a=function(e){try{return n(90)("./".concat(e))}catch(t){if("MODULE_NOT_FOUND"===t.code)throw Error("Incorrect ENVIRONMENT variable set, exiting\nAllowed Environments:\n1. dev\n2. prod")}}(Object({NODE_ENV:"production",PUBLIC_URL:""}).ENVIRONMENT||"prod");e.exports=a},48:function(e,t){e.exports={baseURL:"http://localhost:4444",env:"dev"}},49:function(e,t){e.exports={baseURL:"https://presence-board-echo.herokuapp.com",env:"prod"}},67:function(e,t,n){e.exports=n(136)},90:function(e,t,n){var a={"./":21,"./dev":48,"./dev.js":48,"./index":21,"./index.js":21,"./prod":49,"./prod.js":49};function r(e){var t=c(e);return n(t)}function c(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=c,e.exports=r,r.id=90}},[[67,1,2]]]);
//# sourceMappingURL=main.4ca49d60.chunk.js.map